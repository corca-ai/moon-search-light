# Moon Search Light

> **논문을 검색하면 연구가 보입니다. 키워드를 입력하면 후속 연구 아이디어가 나옵니다.**

## 서비스 소개

**Moon Search Light**는 학술 논문 검색과 AI 분석을 결합하여 후속 연구 아이디어를 도출하는 도구입니다. Semantic Scholar의 2억 건 이상 논문 데이터베이스를 검색하고, AI가 논문을 분석하며, 선택한 논문들을 기반으로 연구 방향을 제안합니다.

## 관련 문서

| 문서 | 설명 |
|------|------|
| [README.md](../README.md) | 프로젝트 소개, 빠른 시작 |
| [ARCHITECTURE.md](./ARCHITECTURE.md) | 기술 아키텍처, API, 컴포넌트 |
| [DESIGN.md](./DESIGN.md) | 디자인 가이드 (색상, 타이포, 컴포넌트) |
| [POSTHOG.md](./POSTHOG.md) | PostHog 분석 설정 |
| [contexts/search-*.md](../contexts/) | 검색 기능 원칙/전략/포맷 |
| [contexts/notes-*.md](../contexts/) | 연구 노트 원칙/전략/포맷 |
| [contexts/ai-analysis-*.md](../contexts/) | AI 분석 원칙/전략/포맷 |
| [contexts/relevance-*.md](../contexts/) | 관련도 분석 원칙/전략/포맷 |
| [contexts/research-assistant-*.md](../contexts/) | Research Assistant 원칙/전략/포맷 |
| [contexts/research-guide-*.md](../contexts/) | Research Guide 원칙/전략/포맷 |

## 해결하는 문제

**논문을 검색하면 연구가 보입니다. 키워드를 입력하면 후속 연구 아이디어가 나옵니다.**

기존 방식의 문제:
- 논문 검색과 분석이 분리되어 있어 맥락 전환 비용이 큼
- 영문 논문 이해에 시간 소모
- 논문 간 관계 파악과 Research Gap 식별이 수동적
- 후속 연구 아이디어 도출까지의 과정이 체계적이지 않음

Moon Search Light는 검색부터 AI 분석, 비교, 아이디어 도출까지 **하나의 워크플로우**로 통합합니다.

## 핵심 가치

- **통합 워크플로우**: 검색 → 분석 → 비교 → 아이디어 도출이 한 화면에서 완결
- **AI 자동 분석**: 논문마다 구조화된 요약(개요, 목표, 방법론, 결과)을 자동 제공
- **관련도 시각화**: 선택한 논문과 검색 결과 간 유사도를 0-100% 스케일로 표시
- **Research Assistant**: AI 대화를 통한 Research Gap 식별과 후속 연구 제안

## 대상 사용자

학술 연구자, 대학원생, 후속 연구 기획자

## 서비스 핵심 개념

서비스는 **3단 레이아웃**의 단일 페이지 중심으로 설계되어 있습니다.

### 통합 플로우

```
랜딩 페이지 → 검색 → AI 분석 → 논문 선택 → 통합 컨텍스트 분석 → Research Assistant 대화 → 아이디어 도출
```

| 단계 | 설명 |
|------|------|
| **랜딩** | 서비스 소개, 시나리오 설명, 히어로 검색창 |
| **검색** | 키워드 입력, Semantic Scholar API 호출, 스마트 정렬 |
| **AI 분석** | 각 논문에 대한 구조화된 한국어 요약 자동 생성 |
| **논문 선택** | 관심 논문 선택(⭐) / 검토 완료(✓) 분류 |
| **관심 주제** | 선택한 논문 기반 연구 관심사 자동 분석 |
| **관련도 표시** | 선택 논문과 검색 결과 간 벡터 유사도 계산 |
| **통합 분석** | 2개 이상 선택 시 공통점/차이점/연구 지형 분석 |
| **Research Assistant** | AI 대화로 후속 연구 아이디어 도출 |

### 페이지 구조

| 경로 | 역할 | 설명 |
|------|------|------|
| `/` | **랜딩 페이지** | 서비스 소개, 3가지 시나리오, 히어로 검색 |
| `/search` | **메인 검색** | 3단 레이아웃 (노트 사이드바 + 검색 + 연구 패널) |

### 레이아웃 구조 (검색 페이지)

**좌측 사이드바 (접힘/펼침)**:
- 로고 + 타이틀
- 연구 노트 목록 (이름, 논문 수, 수정일)
- 노트 생성 (자동 번호 부여: 새 연구, 새 연구 2, ...)
- 노트 이름 변경/삭제

**중앙 메인 콘텐츠**:
- 헤더: 세션 타이틀 (클릭하여 편집), 다운로드 버튼
- 선택 영역: 선택된/검토 완료 논문, 관심 주제 요약
- 검색 영역: 검색창 + 결과 목록 (항상 표시)

**우측 연구 패널 (접힘/펼침, 560px)**:
- 통합 컨텍스트 분석 (리로드 버튼)
- Research Assistant 채팅
- 접힘 시: 48px 바 + "Research" 텍스트 + 메시지 수 배지

## 검색 기능

> 상세 내용: [contexts/search-*.md](../contexts/)

### 데이터 출처

Semantic Scholar API (2억 건 이상 학술 논문)

### 검색 동작

- 최대 100개 결과, 초기 20개 표시, "더 보기"로 추가 로드
- 쿼리 분석: 구체적 쿼리 vs 단순 쿼리 자동 분류

### 정렬 옵션

| 정렬 | 설명 |
|------|------|
| **추천순** (기본) | 연도 가중치(60%) + 인용수 가중치(40%) |
| **관련성** | Semantic Scholar 기본 관련성 순 |
| **최신순** | 발행 연도 내림차순 |
| **인용순** | 인용 수 내림차순 |

## 논문 카드

### 검색 결과 카드

- 썸네일 (ArXiv 스냅샷 이미지)
- 제목, 연도, 인용수, 논문 링크
- AI 분석 결과 (개요, 목표, 방법론, 결과)
- 키워드 태그 (3-5개)
- 초록 번역 토글
- 관련도 스코어 (선택 논문 존재 시)

### 선택된/검토 완료 카드

- 수평 스크롤 카드 (HorizontalPaperCard)
- 클릭 시 상세 모달 (PaperDetailModal)

### 액션

| 버튼 | 동작 |
|------|------|
| ⭐ | 논문을 선택 목록에 추가 |
| ✓ | 논문을 검토 완료로 이동 |
| ☀ | 시드 논문으로 지정 (Research Guide) |
| ★ | 선택 해제 |
| 다시 검토 | 검토 완료된 논문 복원 |

## AI 기능

> 상세 내용: [contexts/ai-analysis-*.md](../contexts/)

### AI 요약

각 논문에 대해 구조화된 한국어 분석을 자동 생성합니다.

| 항목 | 설명 |
|------|------|
| 개요 | 연구의 전체적 내용 |
| 목표 | 연구가 달성하고자 하는 것 |
| 방법론 | 사용된 연구 방법 |
| 결과 | 주요 발견 및 성과 |
| 키워드 | 3-5개 핵심 키워드 |

- 배치 처리: 3개씩 순차 분석
- Zod 스키마 검증으로 응답 구조 보장

### 관심 주제 요약

- 논문 선택 시 자동 분석 (500ms 디바운스)
- 명사형 종결, 100자 이하
- 선택 변경 시 자동 갱신

### 초록 번역

- Gemini 3 Flash로 영문 초록 → 한국어 번역
- 토글 방식으로 원문/번역 전환

### 관련도 표시

> 상세 내용: [contexts/relevance-*.md](../contexts/)

선택한 논문과 검색 결과 간의 주제 연관성을 측정합니다.

- **벡터 임베딩**: text-embedding-3-small 모델로 제목+초록 임베딩
- **코사인 유사도**: 선택 논문 평균 임베딩과 후보 논문 임베딩 비교
- **스케일**: 0-100% (높을수록 비슷한 주제)
- **배치 처리**: 최대 50개 텍스트 동시 임베딩
- **캐싱**: 임베딩 결과 캐시로 중복 API 호출 방지

## Research Guide

> 상세 내용: [contexts/research-guide-*.md](../contexts/)

논문 하나를 시드로 지정하면, 해당 분야의 연구 지형을 탐색할 수 있도록 돕는 기능입니다.

### 흐름

```
시드 논문 지정 → 키워드 추출 → 키워드 클릭 → 검색 실행 → 결과 클러스터링 → 필터링
```

### 시드 논문

- 검색 결과 카드에서 시드 버튼(☀)으로 지정
- 한 번에 1개만 허용, 교체 가능
- abstract 없으면 시드 불가

### 키워드 추출

- Gemini 2.0 Flash로 시드 논문에서 3-5개 탐색용 키워드 추출
- 키워드 칩 형태로 검색창 아래 표시
- 클릭 시 해당 키워드로 즉시 검색

### 자동 클러스터링

- 키워드 검색 후 결과 5개 이상이면 자동 실행
- 3-6개 주제별 클러스터로 분류
- 탭 형태로 필터링 (정렬 드롭다운과 결과 목록 사이)
- 일반 검색에서는 클러스터링 미실행
- 클러스터 선택 시 "세션으로 분리" 버튼 표시 → 클러스터명으로 재검색하여 독립 세션 생성 (논문 복사가 아닌 재검색으로 더 많은 관련 논문 확보)

## Research Assistant

> 상세 내용: [contexts/research-assistant-*.md](../contexts/)

### 우측 패널 구조

- 검색 영역과 동시 표시 가능
- 접기/펼치기로 화면 공간 조절
- 펼침 시 검색 영역 자동 축소

### 통합 컨텍스트 분석

2개 이상 논문 선택 시 활성화되며, "분석" 버튼으로 수동 실행합니다.

| 분석 항목 | 설명 |
|----------|------|
| 공통 문제 | 선택된 논문들이 공유하는 연구 문제 |
| 공통 방법론 | 사용된 유사 연구 방법 |
| 주요 차이점 | 논문 간 접근 방식의 차이 |
| 연구 지형 | 전체적인 연구 동향과 위치 |

### 채팅 기능

- 스트리밍 응답 (SSE 기반)
- 마크다운 렌더링
- 선택 논문 + 컨텍스트 분석 기반 맥락 인식
- 논문 비교 분석, Research Gap 식별, 후속 연구 아이디어 제안

### 연구 개요 다운로드

- 대화 내용을 마크다운 파일로 내보내기
- JSON 형식 내보내기 지원

## 연구 노트 (Session)

> 상세 내용: [contexts/notes-*.md](../contexts/)

사용자의 논문 탐색 과정을 저장하고 관리합니다.

- **용어**: 코드 `Session`, UI "연구 노트"
- **저장소**: localStorage (브라우저 영속)
- **최대 세션 수**: 10개
- **활동 기록**: 검색, 논문 선택, 분석 완료, 채팅 등
- **자동 저장**: Debounce 1초, beforeunload 시 저장
- **다중 탭 동기화**: storage 이벤트 기반 크로스 탭 싱크

## 외부 연동

| 서비스 | 연동 내용 |
|--------|----------|
| **Semantic Scholar** | 논문 검색 API, 논문 상세 페이지 링크 |
| **Moonlight** | ArXiv 논문 뷰어 연동 |
| **ArXiv** | 논문 스냅샷 이미지 (CSV 데이터베이스 기반) |

## API

| 엔드포인트 | 메서드 | 기능 |
|-----------|--------|------|
| `/api/search` | GET | Semantic Scholar 논문 검색 |
| `/api/summarize` | POST | 논문 AI 요약 (구조화된 분석) |
| `/api/translate` | POST | 영문 초록 한국어 번역 |
| `/api/embeddings` | POST | 벡터 임베딩 생성 (배치, 최대 50개) |
| `/api/interest-summary` | POST | 관심 주제 요약 |
| `/api/context-summary` | POST | 통합 컨텍스트 분석 (2개+ 논문) |
| `/api/chat` | POST | Research Assistant 채팅 (스트리밍) |
| `/api/paper-images` | POST | ArXiv 논문 스냅샷 이미지 조회 |
| `/api/research-guide/extract-keywords` | POST | 시드 논문 기반 탐색 키워드 추출 |
| `/api/research-guide/cluster` | POST | 논문 목록 주제별 클러스터링 |

## UX/UI 컴포넌트

| 컴포넌트 | 용도 |
|---------|------|
| **NoteSidebar** | 좌측 연구 노트 관리 (세션 목록, 생성/삭제/이름 변경) |
| **SearchResultCard** | 검색 결과 카드 (분석, 번역, 관련도 표시) |
| **SelectedPapersSection** | 선택/검토 완료 논문 수평 카드 영역 |
| **HorizontalPaperCard** | 선택 영역의 간결한 논문 카드 |
| **PaperDetailModal** | 논문 상세 모달 (메타데이터 + 분석) |
| **ResearchKeywords** | 시드 논문 키워드 칩 (검색창 아래) |
| **ClusterTabs** | 클러스터 필터 탭 (결과 목록 위) |

## 성능 최적화

### 배치 처리
AI 요약은 3개씩 순차 배치로 처리합니다. 임베딩은 최대 50개 텍스트를 한 번의 API 요청으로 전송합니다.

### 임베딩 캐시
계산된 벡터 임베딩을 메모리에 캐시하여 동일 논문에 대한 중복 API 호출을 방지합니다. 요청 취소(AbortController) 기능으로 불필요한 계산을 중단합니다.

### 논문 이미지 캐시
ArXiv 논문 스냅샷 이미지는 CSV 데이터베이스에서 조회하며, 한 번 로드된 이미지는 재요청 없이 표시합니다.

## 데이터 저장

모든 데이터는 **localStorage** 기반으로 브라우저에 저장됩니다.

| 데이터 | 저장 방식 |
|--------|----------|
| 연구 노트 (세션) | localStorage (`session-*` 키) |
| 세션 목록 | localStorage (`session-list` 키) |
| 사용자 이메일 | localStorage (`user-email` 키) |

## 기술 스택

| 영역 | 기술 |
|------|------|
| Frontend | Next.js 16, React 19, TypeScript, Tailwind CSS 3.4 |
| AI | Google Gemini 3 Flash (요약/번역/채팅/키워드 추출/클러스터링), OpenAI text-embedding-3-small (임베딩) |
| 검색 | Semantic Scholar API |
| 검증 | Zod (API 응답 스키마 검증) |
| Analytics | PostHog (클라이언트 + 서버 + 리버스 프록시) |
| 렌더링 | React Markdown (채팅 메시지) |

## 기능 모듈 아키텍처

각 기능은 `app/features/` 하위에 모듈로 분리되며, 일관된 구조를 따릅니다:

```
app/features/{feature}/
├── principles.ts    # 상수, 규칙, 제한값
├── strategies.ts    # 알고리즘, 처리 흐름
├── types.ts         # 타입, 인터페이스
└── index.ts         # 모듈 진입점 (재수출)
```

| 모듈 | 역할 | 컨텍스트 문서 |
|------|------|---------------|
| `search` | 검색, 정렬, 쿼리 분석 | `contexts/search-*.md` |
| `notes` | 연구 노트 CRUD, 활동 기록 | `contexts/notes-*.md` |
| `ai-analysis` | 논문 요약, 컨텍스트 분석 프롬프트 | `contexts/ai-analysis-*.md` |
| `relevance` | 벡터 유사도, 관련도 계산 | `contexts/relevance-*.md` |
| `research-assistant` | 채팅 프롬프트, 내보내기 | `contexts/research-assistant-*.md` |
| `research-guide` | 키워드 추출, 클러스터링 | `contexts/research-guide-*.md` |

## 디자인 원칙

학술 도구로서의 성격을 반영한 절제된 디자인을 적용합니다.

- **색상**: Slate 팔레트 기반, 최소한의 강조색
- **타이포그래피**: Pretendard Variable, 명확한 계층 구조
- **레이아웃**: 3단 구조, 접힘/펼침으로 공간 활용
- **다크 모드**: 시스템 설정 자동 감지
- **아이콘**: SVG 기반, stroke 스타일
